<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Type" content="text/javascript; charset=utf-8" />
		<meta http-equiv="Content-Type" content="text/css; charset=utf-8" />
		<title>jQuery + Google Data API - jiTunesFeed</title>
		<script src="http://www.google.com/jsapi/" type="text/javascript"></script>
		<script type="text/javascript">google.load('jquery', '1')</script>

<script type="text/javascript">
(function($){$.extend({
	// category :  topsongs, newreleases, justadded, topalbums etc...
	jiTunesFeed: function(category, options, callback){
		var data = $.extend({
			'sf':'ja',
			'genre': 0, //R&B/Soul=15, Rock=21, J-Pop=27 , etc ...
			'limit': 10,
			'alt': 'json-in-script'
		}, options);
		
		var countries = {
			ja:143462,
			uk:143444,
			usa:143441
			// etc ...
		};
		
		data.sf = countries[data.sf.toLowerCase()];
		
		callback = $.isFunction(options) ? options : callback || function(){};
		
		$.ajax({
		    dataType: 'jsonp',
			data: data,
		    cache: false,
		    url: 'http://ax.phobos.apple.com.edgesuite.net/WebObjects/MZStore.woa/wpa/MRSS/' + category + '/rss.xml',
		    success: callback
		});
	}
})})(jQuery);


// Usage
$(function(){
	$.jiTunesFeed('topsongs', {'genre':15}, function(data){
			var
			feed = data.feed,
			$div = $('<div>').append($('<h2>').text(feed.description));
			
		    $.each(feed.entries, function(i, entry){
				$div.append(entry.content);
		    });
		
		$div.appendTo(document.body);
	});
});
</script>
<style type="text/css">
</style>
    </head>
    <body>
    	<h2>jQuery Ajax + Google Data API - jBloggerFeed demo</h2>
    </body>
</html>