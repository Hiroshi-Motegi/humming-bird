<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta http-equiv="Content-Type" content="text/css; charset=utf-8"/>
  <meta http-equiv="Content-Type" content="text/javascript; charset=utf-8"/>
  <meta content='Y@$' name='author'/>
  <meta content='iTunes Storeでランキングされたアーティスト、アルバムタイトルをキーワードに検索する' name='description'/>
  <title>humming bird - iTunes Store:Today's Ranking</title>
  <link rel="stylesheet" href="if_style.css" media="screen" type="text/css" />
  <script src="http://www.google.com/jsapi/?key=ABQIAAAAiNKIZn622V1CXDf5kTGF4BT21aFqu3bann7KEuE8AJXctX8bUxQnrQ2TKLZ2miaeY8w2pdh4zTxKRQ"  type="text/javascript"></script>

  <script type="text/javascript">	
	//<![CDATA[
    google.load("search", "1");
	google.load("feeds", "1");
	
	var feedurlstrct = {
		Top:"http://ax.phobos.apple.com.edgesuite.net/WebObjects/MZStore.woa/wpa/MRSS/",
		Middle:"/sf=143462",
		Tail:"/rss.xml",
		Genre:"/genre=",
		Limit:"/limit="
	};
	
	/* 0 = "topsongs" 1 = "topalbums"  2 = "new-releases" */
	var feedCategory = Array();
	feedCategory[0] = "topsongs";
	feedCategory[1] = "topalbums";
	feedCategory[2] = "newreleases";
	feedCategory[3] = "justadded";
	feedCategory[4] = "featuredalbums";
	
	function initialize(fCategory,fGenre){
		
		//カテゴリーとジャンルの値を保持するためにタグに書き出す
		Set_CandG_Val(fCategory,fGenre);
		
		//ドロップダウンリストからエントリー取得数を取得する
		var entryLimit = List_GetSelectedValue("EntryCountList");
		
		//FeedURLを生成する
		var FeedURL = feedurlstrct.Top + feedCategory[fCategory] + feedurlstrct.Middle + feedurlstrct.Limit + entryLimit;
		if (fGenre == 0) {
			FeedURL +=  feedurlstrct.Tail;
		}else{
			FeedURL +=  feedurlstrct.Genre + fGenre + feedurlstrct.Tail;
		}
		//+ "/explicit=false"
		
		//取得したFeedの内容を表示するタグの取得
		container = document.getElementById("feed");
			
		var feed = new google.feeds.Feed(FeedURL);
		
		feed.setNumEntries(entryLimit);
		feed.setResultFormat(google.feeds.Feed.MIXED_FORMAT);
		
		feed.load(function(result){
			if (!result.error) {
				
				//各フィードを格納
				var containerDiv = document.createElement("div");
				containerDiv.className = "feedcontainer";
				
				//フィードタイトルを取得
				var feedDescription = result.feed.description; 
				feedDescription = feedDescription.replace("iTunes Store","");
				feedDescription = feedDescription.replace(":","");
				
				//フィードタイトルを格納
				var FeedTitle = document.createElement("h3");
				FeedTitle.className = "feedtitle";
				FeedTitle.innerHTML = feedDescription;
				containerDiv.appendChild(FeedTitle);

				for (var i = 0; i < result.feed.entries.length; i++) {
				
					var entry = result.feed.entries[i];
					var ns = "http://phobos.apple.com/rss/1.0/modules/itms/";
					var eNode = entry.xmlNode;
					var sapiCallStr = {
						Top:"javascript:OnLoad('",
						End:"');"
						};
					var covorArtSize = {
						small: 0,
						midium: 1,
						large: 2
						};
					
					var CSelected = {
						TitleOnly:"Title_Only",
						Full:"Full_Contents"
						};
					
					//エントリーを格納するタグ
					var entryContainer = document.createElement("div");
					entryContainer.className = "entryCont";
					containerDiv.appendChild(entryContainer);
					
					if (entry.title != null) {
						//エントリータイトルを格納
						var titleAnc = document.createElement('a');
						titleAnc.setAttribute("href", entry.link);
						titleAnc.target = "_blank";
						titleAnc.setAttribute("title", entry.title);
						titleAnc.appendChild(document.createTextNode(entry.title));
						var entryHeader = document.createElement("div");
						entryHeader.className = "entryTitle";
						entryHeader.appendChild(titleAnc);
						entryContainer.appendChild(entryHeader);
					}
					
					if (List_GetSelectedValue("EntryVisibleList") == CSelected.Full) {
						
						//タイトル以外を格納するタグ
						var BaseContent = document.createElement("div");
						BaseContent.className = "basecontent";
						entryContainer.appendChild(BaseContent);
						
						
						//アルバムカバーを格納するタグ
						var coverArtContainer = document.createElement("div");
						coverArtContainer.className = "coverart";
						BaseContent.appendChild(coverArtContainer);
						
						//エントリー情報を格納するタグ
						var entryContent = document.createElement("div");
						entryContent.className = "content";
						var cont_Table = document.createElement("table");
						cont_Table.className = "contTable";
						var cont_Tbody = document.createElement("tbody");
						cont_Tbody.className = "contTbody";
						cont_Table.appendChild(cont_Tbody);
						entryContent.appendChild(cont_Table);
						BaseContent.appendChild(entryContent);
						
						//要素を揃える
						var clearDiv = document.createElement("div");
						clearDiv.className = "clear";
						BaseContent.appendChild(clearDiv);
						
						
						//各エントリーの各情報を取得*********************************************
						//カバーアート
						var coverNodes = google.feeds.getElementsByTagNameNS(eNode, ns, "coverArt")[covorArtSize.large];
						if (coverNodes != null) {
							var coverArt = coverNodes.firstChild.nodeValue;
							var albumNodes = google.feeds.getElementsByTagNameNS(eNode, ns, "albumLink")[0];
							var albumLink = albumNodes.firstChild.nodeValue;
							var imgAnc = document.createElement('a');
							imgAnc.setAttribute("href", albumLink);
							var img = document.createElement('img');
							img.src = coverArt;
							imgAnc.appendChild(img);
							coverArtContainer.appendChild(imgAnc);
						}
						
						
						//アルバムタイトル
						var albumtitleNodes = google.feeds.getElementsByTagNameNS(eNode, ns, "album")[0];
						if (albumtitleNodes != null) {
							var albumTitle_tr = document.createElement("tr");
							var name_album_td = document.createElement("td");
							name_album_td.className = "name_td";
							name_album_td.appendChild(document.createTextNode("Album :"));
							albumTitle_tr.appendChild(name_album_td);
							
							
							var albumTitle = albumtitleNodes.firstChild.nodeValue;
							var albumtitle_td = document.createElement("td");
							
							var albumAnc = document.createElement('a');
							
							albumAnc.appendChild(document.createTextNode(albumTitle));
							
							albumTitle = Edit_Word(albumTitle);
							
							albumAnc.setAttribute("title", "[" + albumTitle + "] でSearch");
							albumAnc.setAttribute("href", sapiCallStr.Top + albumTitle + sapiCallStr.End);
							
							albumtitle_td.appendChild(albumAnc);
							albumTitle_tr.appendChild(albumtitle_td);
							
							cont_Tbody.appendChild(albumTitle_tr);
						}
						
						
						//アーティスト
						var artistNodes = google.feeds.getElementsByTagNameNS(eNode, ns, "artist")[0];
						if (artistNodes != null) {
							var artist_tr = document.createElement("tr");
							var name_artist_td = document.createElement("td");
							name_artist_td.className = "name_td";
							name_artist_td.appendChild(document.createTextNode("Artist :"));
							artist_tr.appendChild(name_artist_td);
							
							var artist = artistNodes.firstChild.nodeValue;
							
							var artist_td = document.createElement("td");
							var artistAnc = document.createElement('a');
							artistAnc.appendChild(document.createTextNode(artist));
							
							artist = Edit_Word(artist);
							
							artistAnc.setAttribute("title", "[" + artist + "] でSearch");
							artistAnc.setAttribute("href", sapiCallStr.Top + artist + sapiCallStr.End);
							
							artist_td.appendChild(artistAnc);
							artist_tr.appendChild(artist_td);
							
							cont_Tbody.appendChild(artist_tr);
						}
						
						//プライス
						var priceNodes = google.feeds.getElementsByTagNameNS(eNode, ns, "albumPrice")[0];
						if (priceNodes != null) {
							var price_tr = document.createElement("tr");
							var name_price_td = document.createElement("td");
							name_price_td.className = "name_td";
							name_price_td.appendChild(document.createTextNode("Price :"));
							price_tr.appendChild(name_price_td);
							
							var price = priceNodes.firstChild.nodeValue;
							var price_td = document.createElement("td");
							price_td.appendChild(document.createTextNode(price));
							price_tr.appendChild(price_td);
							
							cont_Tbody.appendChild(price_tr);
						}
						
						//リリース日
						var releaseNodes = google.feeds.getElementsByTagNameNS(eNode, ns, "releasedate")[0];
						if (releaseNodes != null) {
							var release_tr = document.createElement("tr");
							var name_release_td = document.createElement("td");
							name_release_td.className = "name_td";
							name_release_td.appendChild(document.createTextNode("Release :"));
							release_tr.appendChild(name_release_td);
							
							var release = releaseNodes.firstChild.nodeValue;
							var release_td = document.createElement("td");
							release_td.appendChild(document.createTextNode(release));
							release_tr.appendChild(release_td);
							
							cont_Tbody.appendChild(release_tr);
						}
						
						//Copyright
						try {
							var rightsNodes = google.feeds.getElementsByTagNameNS(eNode, ns, "rights")[0];
							if (rightsNodes != null) {
								var rights = rightsNodes.firstChild.nodeValue;
								var rightsP = document.createElement("p");
								rightsP.className = "cprght";
								rightsP.title = "Copyright " + rights;
								rightsP.appendChild(document.createTextNode("Copyright " + rights));
								entryContent.appendChild(rightsP);
							}
						} 
						catch (e) {
						}
					}
				}
				
				//コンテンツを表示
				container.appendChild(containerDiv);
				
				//以前に表示していたものがあれば削除
				var tgtParent=document.getElementById("feed");
				var tgt_firstchild=tgtParent.firstChild;
				if (tgt_firstchild.nextSibling) {
					tgtParent.removeChild(tgtParent.firstChild);
				}
			}
		});
	}
	
	
	google.setOnLoadCallback(initialize());
	
	
	//***********************************************
    function OnLoad(queryWord) {
      var searchControl = new google.search.SearchControl();

      searchControl.addSearcher(new google.search.VideoSearch());
      searchControl.addSearcher(new google.search.WebSearch());
      searchControl.addSearcher(new google.search.NewsSearch());
      searchControl.addSearcher(new google.search.ImageSearch());

      searchControl.draw(document.getElementById("SearchResult"));

      searchControl.execute(queryWord);
    }
    
    google.setOnLoadCallback(OnLoad(), false);
	

	//***********************************************
	function Edit_Word(tgtStr){

		tgtStr = tgtStr.replace(" - Single","");
		tgtStr = tgtStr.replace(" - EP","");
		tgtStr = tgtStr.replace("\"","");
		tgtStr =tgtStr.replace("\'","\\\'");
		
		if(tgtStr.indexOf("(") > 0){
			tgtStr = tgtStr.substring(0,tgtStr.indexOf("("));
		}
		if(tgtStr.indexOf("~") > 0){
			tgtStr = tgtStr.substring(0,tgtStr.indexOf("~"));
		}
		tgtStr = tgtStr.replace("｢","");
		tgtStr = tgtStr.replace("｣","");
		
		if (tgtStr.lastIndexOf(" ") > 0) {
			if (tgtStr.length == (tgtStr.lastIndexOf(" ") + 1)) {
				tgtStr = tgtStr.substring(0,tgtStr.length -1);
			}
		}
		return tgtStr;
	}
	//***********************************************
	function Content_Clear(tgtPID){
		try {
			var tgtParent=document.getElementById(tgtPID);
			var tgt_firstchild=tgtParent.firstChild;
			
			while (tgt_firstchild.nextSibling){
				tgtParent.removeChild(tgt_firstchild.nextSibling);
			}
			
			tgtParent.removeChild(tgt_firstchild);
		} catch (e) {} 
	}//**********************************************
	
	function List_GetSelectedValue(id_name){
		var element;
		try{
				element = document.getElementById(id_name);
				return element.options[element.selectedIndex].value;
			}catch (e) {}
	}//**********************************************
	
	function Set_CandG_Val(cVal,gVal){
		var ctag = document.getElementById("categoryVal");
		ctag.value = cVal;
		var gtag = document.getElementById("genreVal");
		gtag.value = gVal;
	}//**********************************************
	
	function List_SelectedValue_Changed(){
		var ctag = document.getElementById("categoryVal");
		var gtag = document.getElementById("genreVal");
		initialize(ctag.value,gtag.value);
	}
	//]]>*********************************************
  </script>

</head>
	<body onload="initialize(0,0); OnLoad('');">
		<div id="Header-Wrapper">
			<div class="header"><img src="if_header.png"/></div>
		</div>
		<!-- fCategory, fGenre -->
		<!-- fCategory    0 = "topsongs" 1 = "topalbums"  2 = "new-releases" -->
		<!-- fGenre    None:0, Pop:14, J-Pop:27, R&B/Soul:15, Hip Hop/Rap:18, Rock:21 -->
		<div id= Outer-Wrapper>
			<div id="Sidebar-Wrapper">
				<div id="FMenuList">
					<ul class="Menu_ul">
						<li class="Menu_li MenuTitle">Top Songs</li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,0);">All Genre</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,27);">J-Pop</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,14);">Pop</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,21);">Rock</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,15);">R&B/Soul</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,2);">Blues</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,23);">Vocal</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,24);">Reggae</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,18);">Hip Hop/Rap</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,17);">Dance</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,11);">Jazz</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,6);">Country</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(0,19);">World</a></li>
					</ul>
					<ul class="Menu_ul">
						<li class="Menu_li MenuTitle">Top Albums</li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,0);">All Genre</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,27);">J-Pop</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,14);">Pop</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,21);">Rock</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,15);">R&B/Soul</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,2);">Blues</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,23);">Vocal</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,24);">Reggae</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,18);">Hip Hop/Rap</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,17);">Dance</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,11);">Jazz</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,6);">Country</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(1,19);">World</a></li>
					</ul>
					<ul class="Menu_ul">
						<li class="Menu_li MenuTitle">New Release</li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,0);">All Genre</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,27);">J-Pop</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,14);">Pop</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,21);">Rock</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,15);">R&B/Soul</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,2);">Blues</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,23);">Vocal</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,24);">Reggae</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,18);">Hip Hop/Rap</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,17);">Dance</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,11);">Jazz</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,6);">Country</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(2,19);">World</a></li>
					</ul>
					<ul class="Menu_ul">
						<li class="Menu_li MenuTitle">Just Added</li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,0);">All Genre</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,27);">J-Pop</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,14);">Pop</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,21);">Rock</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,15);">R&B/Soul</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,2);">Blues</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,23);">Vocal</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,24);">Reggae</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,18);">Hip Hop/Rap</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,17);">Dance</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,11);">Jazz</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,6);">Country</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(3,19);">World</a></li>
					</ul>
					<ul class="Menu_ul">
						<li class="Menu_li MenuTitle">Featured & Exclusive Albums</li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,0);">All Genre</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,27);">J-Pop</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,14);">Pop</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,21);">Rock</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,15);">R&B/Soul</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,2);">Blues</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,23);">Vocal</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,24);">Reggae</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,18);">Hip Hop/Rap</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,17);">Dance</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,11);">Jazz</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,6);">Country</a></li>
						<li class="Menu_li li_Child">≫ <a href="javascript:initialize(4,19);">World</a></li>
					</ul>
				</div>
				
				<div class="MenuTitle">Option</div>
				<div id="EntryOptions">
					<form id="EntryOptionsForm">
						<table><tbody><tr>
							<td><label for="name">Entry:</label></td>
							<td><select id="EntryCountList" class="DDList" title="ランキング表示数"  onchange="List_SelectedValue_Changed()">
			    				<option value="10" class="listOption">10</option>
			    				<option value="20" class="listOption">20</option>
			    				<option value="30" class="listOption">30</option>
								<option value="50" class="listOption">50</option>
								<option value="100" class="listOption">100</option>
							</select></td>
						</tr>
						<tr>
							<td><label for="name">Value:</label></td>
							<td><select id="EntryVisibleList" class="DDList" title="ランキング表示スタイル" onchange="List_SelectedValue_Changed()">
			    				<option value="Full_Contents" class="listOption">Full Contents</option>
			    				<option value="Title_Only" class="listOption">Title Only</option>
							</select></td>
						</tr></tbody></table>
						<input type= "text" id="categoryVal" class="hiddenValue"></input>
						<input type= "text" id="genreVal" class="hiddenValue"></input>
					</form>
				</div>
				<div class="MenuTitle"><a href="javascript:Content_Clear('feed');  OnLoad('');" title="コンテンツをすべて削除します">Clear</a></div>
				<div class="MenuTitle">▽免責事項▽</div>
				<div  class="disclaimer">このサイトをご利用した際に起こったいかなる損害も、制作者 Y@$ 及び humming bird はその責を負いません。
				<br/>ご自身の責任においてご利用ください。</div>
			</div><!-- Sidebar-Wrapper End -->
			
			<div id="Content-Wrapper">
				<noscript>当サイトはJavaScriptを使用してコンテンツを表示しています。<br/> コンテンツを表示させるにはJavaScriptを許可する必要があります。</noscript>
				<div id="feed">Loading...</div>
				<div id="SearchResult">Loading...</div>
				<div class="clear"></div>
			</div><!-- Content-Wrapper End -->

			<div class="clear"></div>
		</div><!-- Outer-Wrapper End -->
		<div id="Footer-Wrapper">
			<div class="Liner"></div>
			<div class="footerContent">
				<br/><span  class="copyright">©2008 iTunes K.K, ©2008 <a href="http://yas-hummingbird.blogspot.com">humming bird</a>. author:Y@$</span>
				<br/><br/><img src="http://www.3counters.net/services/wcounter/wcounter.php?s=9B104E02F9F327C751D2ADC84D063621726629288657D639067D21C39EAC40B5C94B7AA21BA52AC8C17F76"  border="0" />
				<br/><br/>
			</div>
		</div>
	</body>
</html>