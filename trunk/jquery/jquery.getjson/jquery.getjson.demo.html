<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Type" content="text/javascript; charset=utf-8" />
		<meta http-equiv="Content-Type" content="text/css; charset=utf-8" />
		<title>jQuery getJSON - demo</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>

<script type="text/javascript">
(function($){
$.flickrPics = function(tag, fn){
	$.getJSON('http://api.flickr.com/services/feeds/photos_public.gne?tagmode=any&format=json&jsoncallback=?&tags=' + tag, fn);
}

$.tweets = function(name, params, callback){
	if($.isFunction(params)){
		 callback = params;
		 params = {};
	}
	
	if (params.since)
		params.since = encodeURIComponent(new Date(params.since));
	
	$.getJSON('http://twitter.com/status/user_timeline/' + name + '.json?&callback=?', params, callback);
}

$.twitterUserInfo = function(name, callback){
	$.getJSON('http://twitter.com/status/user_timeline/' + name + '.json?&callback=?',
		function(data){
			callback.call(this, data[0].user);
		});
}

$.twitterSeach = function(keyword, callback){
	$.getJSON('http://search.twitter.com/search.json?callback=?&q=' + keyword, callback);
}


$.bloggerFeed = function(domain, fn){
	$.getJSON('http://www.google.com/reader/public/javascript/feed/http://' + domain + 
		'.blogspot.com/atom.xml?alt=json&n=10&callback=?', fn);
}

})(jQuery);



$(function(){
	var tag = 'color';
	$.flickrPics( tag, function (data) {
		$(document.body).append('<h3>flickr Pics - Tag : ' + tag + '</h3>');
	    $.each(data.items, function(i, item){
			$('<img>')
				.attr('src', item.media.m)
				.appendTo(document.body);
	    });
	});
	
	
	//15421866 or gihren
	$.tweets('15421866', {
		since:'2009/05/01',
		count:'3'
		}, function(data){
		$(document.body).append('<h3>Tweets</h3>');
		$('<ul>').append($.map(data, 
		function(t, i){
			return '<li>' + t.text + '</li>';
		}).join('')).appendTo(document.body);
	});
	
	$.twitterUserInfo('gihren', function(data){
		$(document.body).append('<h3>Twitter User Info</h3>');
		var list = [];
		for (var item in data)
			list.push('<li>' + item + ' : ' + data[item] + '</li>');
		$('<ul>').append(list.join('')).appendTo(document.body);
	});
	
	var keyword = 'jQuery';
	$.twitterSeach(keyword, function(data){
		$(document.body).append('<h3>Twitter Seach - keyword : ' + keyword + '</h3>');
		var list = [];
		$.each(data, function(i, tw) {
			for(var i = 0; i < tw.length; i++)
				if (tw[i].text) { list.push('<li>' + tw[i].text + '</li>'); }
		});
		$('<ul>').append(list.join('')).appendTo(document.body);
	});
	
	
	//気分でjQueryを使わずに書いてみた。
	var domain = 'googlejapan';
	$.bloggerFeed(domain, function ( data ){
		
		var h3 = document.createElement('h3');
		h3.appendChild(document.createTextNode('Blogger Feed - ' + domain));
		document.body.appendChild(h3);
		
		var list = document.createElement('ul');
		
		for (i in data.items) {
			var item = data.items[i];
			var post = document.createElement('li');
			
			var link = document.createElement('a');
			link.appendChild(document.createTextNode(item.title));
			link.href = item.alternate.href;
			post.appendChild(link);
			
			var timestamp = document.createElement('span');
			timestamp.appendChild(document.createTextNode(' - ' + 
				(function( date ){
					return date.getFullYear() + '年' + (date.getMonth() + 1) + '月' + date.getDate() + '日';
				})(new Date(item.published * 1000))));
			post.appendChild(timestamp);
			
			list.appendChild(post);
		}
		
		document.body.appendChild(list);
	});

});
</script>

<style type="text/css">
</style>
    </head>
    <body>
    	<h1>jQuery getJSON - demo</h1>
    </body>
</html>