<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Script-Type" content="text/javascript; charset=utf-8" />
	<meta http-equiv="Content-Style-Type" content="text/css; charset=utf-8" />
		<meta content="y@s" name="author"/>
		<title>memo</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js" type="text/javascript"></script>
<!--[if IE]>
<style type="text/css">
body {width:expression( documentElement.clientWidth < 900 ? (documentElement.clientWidth == 0 ? (body.clientWidth < 900 ? "900" : "auto") : "900px") : "auto" )}
</style>
<![endif]-->

<script type="text/javascript">
$(function(){
/*
text() は文字列だけを取得することができる
appendは","で区切って複数追加可能
wrap bug
each:falseを返すと処理を中断できる
clone:引数にtrueを指定するとイベントもコピーされる。
animationで指定するopacityはtoggleを指定できる
mapは配列が線形化される
*/

var list = '<ul><li>' + ['item 1', 'item 2', 'item 3'].join('</li><li>') + '</li></ul>';
/*list
<ul>
	<li>item1</li>
	<li>item2</li>
	<li>item3</li>
</ul>
*/


//イベントの発生源を取得する
//var target = event.target || event.srcElement;


//--------------------------------------------------------------------------
//Add Event
var addListener = (function() {
    if ( window.addEventListener ) {
        return function(el, type, fn) {
            el.addEventListener(type, fn, false);
        };
    } else if ( window.attachEvent ) {
        return function(el, type, fn) {
            el.attachEvent('on'+type, function() {
                fn.call(el, window.event);
            });
        };
    } else {
        return function(el, type, fn) {
            el['on'+type] = fn;
        }
    }
})();

//--------------------------------------------------------------------------
function prettify(source) {
	alert('prettify');
	var fun;
	try {
		fun = new Function(source);
	} catch (error if error instanceof SyntaxError) {
		return null;
	}
	return fun.toSource(0).split('\n').slice(1, -1).join('\n').replace(/^\s{4}/gm, '');
}



document.addEventListener("DOMContentLoaded", function (e){
	
	alert('addEventListener');

	var
	source = document.getElementById('txtr'),//textarea
	button = document.getElementsByName('button'),
	pre = document.getElementById('preCode'); //pre
	
	button.addEventListener('click',function () {
		pre.textContent = prettify(source.value) || 'syntax error';
	},false);

}, false);





//--------------------------------------------------------------------------
function $$(id){
	return document.getElementById(id);
}

function isExist(id){
	return $$(id) != null;
}

//子要素が0の場合、ちゃんと0を返してくれる。
function hasChild(elm){
	if (elm == null) {
		return false;
	}
	else {
		return elm.hasChildNodes();
	}
}

function lastChildIndex(elm){
	if(hasChild(elm))
		return $(elm).children().index($(elm).children(":last"));
}

//クロスブラウザなfirstChild
function firstChild(elm){
	var nd = elm.firstChild;
	while (nd.nodeType != 1 && nd) {
		nd = nd.nextSibling;
	}
	return nd;
}
//--------------------------------------------------------------------------
function makeClojure(){
	var i = 0;
	return function(){
		return i++;
	};
}



//--------------------------------------------------------------------------
function searchItunes(keyword) {
	var lang = 9,
		country = 'JP',
		media = 'music',
		entity = 'album',
		limit = 20,
		term = encodeURI(keyword),
		output = 'json',
		url = 'http://phobos.apple.com/WebObjects/MZSearch.woa/wa/itmsSearch',
		params = 'lang=' + lang + '&country=' + country + '&media=' +
			media + '&entity=' + entity + '&limit=' + limit + '&term=' +
			term +'&output=' + output;

	window.open(url + '?' + params, "_blank");
}

});


</script>
<style type="text/css">
* html selector {
	filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=crop, src='images/img.png');
}

selector{
	filter: alpha(opacity=50);
	-moz-opacity:0.5;
	-khtml-opacity:0.5;
	opacity:0.5;
}
</style>
</head>
<body>
	<h1>memo</h1>
	<ul>
		<li><a href="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js" title="">http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js</a></li>
		<li><a href="http://code.jquery.com/jquery-latest.min.js" title="">http://code.jquery.com/jquery-latest.min.js</a></li>
	</ul>

<div id='tt'>
	<pre id='preCode'>foo</pre>
	<textarea id='txtr' rows='12' cols='80' name='textarea'>
	function foo(){
		alert('foo');
	}
	</textarea>
	<input type='button' name='button' value='do'/>
</div>

</body>
</html>